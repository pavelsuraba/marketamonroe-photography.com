/*! Ajax-Include - v0.1.3 - 2014-05-21
* http://filamentgroup.com/lab/ajax_includes_modular_content/
* Copyright (c) 2014 @scottjehl, Filament Group, Inc.; Licensed MIT */
(function(e,t,n){var r={boundAttr:"data-ajax-bound",interactionAttr:"data-interaction",makeReq:function(t,n,r){e.get(t,function(e,t,r){n.trigger("ajaxIncludeResponse",[e,r])})},plugins:{}};e.fn.ajaxInclude=function(n){function u(t){var n=t.data("url");o.proxy&&e.inArray(n,i)===-1?(i.push(n),s=s.add(t)):r.makeReq(n,t)}function a(){i.length&&(r.makeReq(o.proxy+i.join(","),s),s=e(),i=[])}function f(e,n){function i(){u(e),a(),r.removeListener(i)}var r=t.matchMedia(n);r.addListener&&r.addListener(i)}var i=[],s=e(),o={proxy:null};return typeof n=="string"?o.proxy=n:o=e.extend(o,n),this.not("["+r.boundAttr+"]").not("["+r.interactionAttr+"]").each(function(n){var i=e(this),s=i.attr("data-media"),a=["append","replace","before","after"],l,c,h=!1,p=i.attr("data-target");for(var d=a.length,v=0;v<d;v++)i.is("[data-"+a[v]+"]")&&(l=a[v],c=i.attr("data-"+l));c||(c=i.attr("href")||i.attr("action"),h=!0),l==="replace"&&(l+="With"),i.data("method",l).data("url",c).data("target",p).attr(r.boundAttr,!0).each(function(){for(var e in r.plugins)r.plugins[e].call(this,o)}).bind("ajaxIncludeResponse",function(t,n,r){var s=n,u=p?e(p):i;if(o.proxy){var a=s.match(new RegExp("<entry url=[\"']?"+i.data("url")+"[\"']?>(?:(?!</entry>)(.|\n))*","gmi"));a&&(s=a[0])}var f=i.triggerHandler("ajaxIncludeFilter",[s]);f&&(s=f),l==="replaceWith"?(i.trigger("ajaxInclude",[s]),u[i.data("method")](s)):(u[i.data("method")](s),i.trigger("ajaxInclude",[s]))}),h?r.makeReq(c,i,!0):!s||t.matchMedia&&t.matchMedia(s).matches?u(i):s&&t.matchMedia&&f(i,s)}),a(),this},t.AjaxInclude=r})(jQuery,this);